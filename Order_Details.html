<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>jQuery Mobile: Theme Download</title>
	<link rel="stylesheet" href="themes/JobSheet1.min.css" />
	<link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
	<link rel="stylesheet" href="Script/jquery.mobile.structure-1.4.5.min.css" />
        <script src="Script/jquery-1.11.2.js" type="text/javascript"></script>
        <script src="Script/jquery.mobile-1.4.5.min.js" type="text/javascript"></script>   
    <link rel="stylesheet" href="Script/jquery.dataTables.min.css"/>
    <script type="text/javascript" src="Script/jquery.dataTables.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {      
                        
            $.ajax({
                type: "POST",
                contentType: "application/json; charset:utf-8",
                url: localStorage.getItem('WcfURL') + "/GetOrderDetails",
                data:"{}",
                dataType: "json",                
                async: true,
                cache: false,
                success: function(response) {
                var data = jQuery.parseJSON(response.d.toString());                
                var tr;
                tr = $("<thead><tr></tr></thead>");
                tr.append("<th>Job_ID</th><th>Cust_Name</th><th>DueDate</th><th>Status</th>"); // bind table header row
                $("#OrderTable").append(tr);
                if (data.NewDataSet.Table.length == undefined) {
                    tr = $("<tbody><tr></tr></tbody>");
                    tr.append("<td><a href='#' data-rel='popup' onclick='popup(" + data.NewDataSet.Table.Job_ID + ")'>" + data.NewDataSet.Table.Job_ID + "</a></td><td>" +
                        data.NewDataSet.Table.FirstName + "</td><td>" +
                        data.NewDataSet.Table.DueDate + "</td><td>" +
                        data.NewDataSet.Table.Status + "</td><td>");
                    $("#OrderTable").append(tr);
                } else {
                    for (var i = 0; i < data.NewDataSet.Table.length; i++) {
                        tr = $("<tbody><tr></tr></tbody>");
                        tr.append("<td><a href='#' data-rel='popup' onclick='popup(" + data.NewDataSet.Table[i].Job_ID + ")'>" + data.NewDataSet.Table[i].Job_ID + "</a></td><td>" +
                            data.NewDataSet.Table[i].FirstName + "</td><td>" +
                            data.NewDataSet.Table[i].DueDate + "</td><td>" +
                            data.NewDataSet.Table[i].Status + "</td><td>");
                        $("#OrderTable").append(tr);
                    }
                }
//                    $('#OrderTable').dataTable(); 
                },
                error: function (response) {                    
                }
            });                        
                $("#txtJobId").change(function () {
                    $("#OrderTable td").remove();
                    $("#OrderTable tr").remove();
                    $.ajax({
                        type: "POST",
                        contentType: "application/json; charset:utf-8",
                        url: localStorage.getItem('WcfURL') + "/GetParticularOrderDetails",
                        data: "{'jobid': '" + $('#txtJobId').val() + "'}",
                        dataType: "json",
                        async: true,
                        cache: false,
                        success: function (response) {
                            var data = jQuery.parseJSON(response.d.toString());
                            var tr;
                            tr = $("<tr></tr>");
                            tr.append("<th>Job_ID</th><th>BrandName</th><th>ModelName</th><th>Warranty</th>"); // bind table header row                         
                            if (data.NewDataSet.Table.length == undefined) {
                                tr = $("<tr></tr>");
                                tr.append("<td><a href='#' data-rel='popup' onclick='popup(" + data.NewDataSet.Table.Job_ID + ")'>" + data.NewDataSet.Table.Job_ID + "</a></td><td>" +
                                    data.NewDataSet.Table.FirstName + "</td><td>" +
                                    data.NewDataSet.Table.DueDate + "</td><td>" +
                                    data.NewDataSet.Table.Status + "</td><td>");
                                $("#OrderTable").append(tr);
                            } else {
                                for (var i = 0; i < data.NewDataSet.Table.length; i++) {
                                    tr = $("<tr></tr>");
                                    tr.append("<td><a href='#' data-rel='popup' onclick='popup(" + data.NewDataSet.Table[i].Job_ID + ")'>" + data.NewDataSet.Table[i].Job_ID + "</a></td><td>" +
                                        data.NewDataSet.Table[i].FirstName + "</td><td>" +
                                        data.NewDataSet.Table[i].DueDate + "</td><td>" +
                                        data.NewDataSet.Table[i].Status + "</td><td>");
                                    $("#OrderTable").append(tr);
                                }
                            }
                        },
                        error: function (response) {                        
                        }
                    });
            });
        });
        function popup(e) {            
            var url = "JobDetails.htm";            
            localStorage.setItem('jobid', e);
            $(location).attr('href', url);
        }
    </script>
</head>
<body >
	<div data-role="page" data-theme="a">
		<div data-role="header" data-position="fixed">
			<h1>Service Management</h1>                  
           <a href="jobsheet.html" data-rel="popup" data-transition="slide" data-position-to="window" data-theme="b" data-inline="true" data-icon="home" data-iconpos="notext" data-direction="reverse" rel="external">Home</a>
          <a href="Logout.html" data-transition="slide" data-theme="b" data-inline="true" data-icon="power" data-iconpos="notext" data-direction="reverse" rel="external">Logout</a>
            <div data-role="popup" id="popupPanel" data-corners="false" data-theme="none" data-shadow="false" data-tolerance="0,0">
				<button data-theme="a" data-icon="back" data-mini="true">Back</button>
				<button data-theme="a" data-icon="grid" data-mini="true">Menu</button>
				<button data-theme="a" data-icon="search" data-mini="true">Search</button>
			</div>
		    <div data-role="navbar" data-grid="d">
		        
		        <ul>
		            <li><a href="jobsheet.html" rel="external">Job Sheet</a></li>
		            <li><a href="Order_Details.html"  class="ui-btn-active">Order Details</a></li>
		            <li><a href="Service.htm" rel="external">Service</a></li>								
		            <li><a href="Company.html" rel="external">Company</a></li>
<li><a href="Invoice.html" rel="external">Invoice</a></li>
		        </ul>
		    </div>      
            <div data-role="navbar" data-grid="b">
			<ul>
				<li><a href="Order_Details.html" class="ui-btn-active">All Orders</a></li>
			    <li><a href="Sort_Orders.html" rel="external">Sort Orders</a></li>				
                <li><a href="AddToFollowUp.html" rel="external">Follow Up</a></li>				
			</ul>
		</div>
		</div>
		
	    <div data-role="content" >
	        <form>
	            <ul data-role="listview" data-inset="true">
		    <li data-role="fieldcontain">                        
        <label for="day">Job ID</label>
        <input type="text" id="txtJobId"  name="txtJobId"/>
            </li>
	            <li data-role="fieldcontain">                        
	                <table  id="OrderTable"  class="table table-striped">
	                        
	                </table>                                             	          
	            </li>
                </ul>	           
	        </form>		        
	    </div>
        <div data-role="footer" data-position="fixed">
			<h4><a href="http://www.createalytics.com" data-rel="external">www.createalytics.com</a></h4>
		</div>	        
		</div>
</body>
</html>